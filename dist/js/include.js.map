{"version":3,"sources":["include.js"],"names":["window","document","undefined","Include","prototype","forEach","array","callback","size","length","i","apply","getFilePath","curWwwPath","location","href","pathName","pathname","localhostPath","substring","indexOf","projectName","substr","lastIndexOf","getFileContent","url","ie","navigator","userAgent","o","ActiveXObject","XMLHttpRequest","open","send","responseText","parseNode","content","objE","createElement","innerHTML","childNodes","executeScript","mac","r","exec","eval","getHtml","replace","getPrevCount","src","count","getRequestUrl","filePath","test","prevCount","this","replaceIncludeElements","$this","includeTals","getElementsByTagName","getAttribute","parent","parentNode","includeNodes","insertBefore","removeChild","onload"],"mappings":"CAIA,SAAUA,OAAQC,SAAUC,WACxB,GAAIC,SAAU,YACdA,SAAQC,WAEJC,QAAS,SAASC,EAAOC,GAErB,IAAI,GADAC,GAAOF,EAAMG,OACTC,EAAIF,EAAO,EAAGE,GAAK,EAAGA,IAC1BH,EAASI,MAAML,EAAMI,IAAKA,KAGlCE,YAAa,WACT,GAAIC,GAAWb,OAAOC,SAASa,SAASC,KACpCC,EAAShB,OAAOC,SAASa,SAASG,SAClCC,EAAcL,EAAWM,UAAU,EAAEN,EAAWO,QAAQJ,IACxDK,EAAYL,EAASG,UAAU,EAAEH,EAASM,OAAO,GAAGC,YAAY,KAAK,EACzE,OAAOL,GAAcG,GAGzBG,eAAgB,SAASC,GACrB,GAAIC,GAAKC,UAAUC,UAAUR,QAAQ,QAAU,EAC3CS,EAAIH,EAAK,GAAII,eAAc,qBAAuB,GAAIC,eAG1D,OAFAF,GAAEG,KAAK,MAAOP,GAAK,GACnBI,EAAEI,KAAK,MACAJ,EAAEK,cAEbC,UAAW,SAASC,GAChB,GAAIC,GAAOpC,SAASqC,cAAc,MAElC,OADAD,GAAKE,UAAYH,EACVC,EAAKG,YAEhBC,cAAe,SAASL,SAGpB,IAFA,GAAIM,KAAM,gCACNC,EAAI,GACFA,EAAID,IAAIE,KAAKR,UACfS,KAAKF,EAAE,KAGfG,QAAS,SAASV,GACd,GAAIM,GAAM,+BAEV,OADAN,GAAQW,QAAQL,EAAK,IACdN,GAEXY,aAAc,SAASC,GAGnB,IAFA,GAAIP,GAAM,UACNQ,EAAQ,EACNR,EAAIE,KAAKK,IACXC,GAEJ,OAAOA,IAEXC,cAAe,SAASC,EAAUH,GAC9B,GAAG,aAAaI,KAAKJ,GAAO,MAAOA,EAEnC,KADA,GAAIK,GAAYC,KAAKP,aAAaC,GAC5BK,KACFF,EAAWA,EAASjC,UAAU,EAAEiC,EAAS9B,OAAO,GAAGC,YAAY,KAAK,EAExE,OAAO6B,GAAW,IAAIH,EAAIF,QAAQ,UAAW,KAEjDS,uBAAwB,WACpB,GAAIC,GAAQF,KACRH,EAAWK,EAAM7C,cACjB8C,EAAczD,SAAS0D,qBAAqB,UAChDJ,MAAKlD,QAAQqD,EAAa,WAStB,IAAI,GAPAT,GAAMM,KAAKK,aAAa,OAExBxB,EAAUqB,EAAMjC,eAAeiC,EAAMN,cAAcC,EAAUH,IAE7DY,EAASN,KAAKO,WACdC,EAAeN,EAAMtB,UAAUsB,EAAMX,QAAQV,IAC7C5B,EAAOuD,EAAatD,OAChBC,EAAI,EAAGA,EAAIF,EAAME,IACrBmD,EAAOG,aAAaD,EAAa,GAAIR,KAGzCE,GAAMhB,cAAcL,GACpByB,EAAOI,YAAYV,UAK/BvD,OAAOkE,OAAS,YACZ,GAAI/D,UAAUqD,2BAEnBxD,OAAQC","file":"include.js","sourcesContent":["/**\r\n * Created by 张永风 on 2016/1/13.\r\n * 引入这个js后，再用<include src=\"js.html\"></include>就可以载入这个页面的内容\r\n */\r\n(function(window, document, undefined) {\r\n    var Include = function() {}\r\n    Include.prototype = {\r\n        //倒序循环\r\n        forEach: function(array, callback) {\r\n            var size = array.length;\r\n            for(var i = size - 1; i >= 0; i--){\r\n                callback.apply(array[i], [i]);\r\n            }\r\n        },\r\n        getFilePath: function() {\r\n            var curWwwPath=window.document.location.href;\r\n            var pathName=window.document.location.pathname;\r\n            var localhostPath=curWwwPath.substring(0,curWwwPath.indexOf(pathName));\r\n            var projectName=pathName.substring(0,pathName.substr(1).lastIndexOf('/')+1);\r\n            return localhostPath+projectName;\r\n        },\r\n        //获取文件内容\r\n        getFileContent: function(url) {\r\n            var ie = navigator.userAgent.indexOf('MSIE') > 0;\r\n            var o = ie ? new ActiveXObject('Microsoft.XMLHTTP') : new XMLHttpRequest();\r\n            o.open('get', url, false);\r\n            o.send(null);\r\n            return o.responseText;\r\n        },\r\n        parseNode: function(content) {\r\n            var objE = document.createElement(\"div\");\r\n            objE.innerHTML = content;\r\n            return objE.childNodes;\r\n        },\r\n        executeScript: function(content) {\r\n            var mac = /<script>([\\s\\S]*?)<\\/script>/g;\r\n            var r = \"\";\r\n            while(r = mac.exec(content)) {\r\n                eval(r[1]);\r\n            }\r\n        },\r\n        getHtml: function(content) {\r\n            var mac = /<script>([\\s\\S]*?)<\\/script>/g;\r\n            content.replace(mac, \"\");\r\n            return content;\r\n        },\r\n        getPrevCount: function(src) {\r\n            var mac = /\\.\\.\\//g;\r\n            var count = 0;\r\n            while(mac.exec(src)) {\r\n                count++;\r\n            }\r\n            return count;\r\n        },\r\n        getRequestUrl: function(filePath, src) {\r\n            if(/http:\\/\\//g.test(src)){ return src; }\r\n            var prevCount = this.getPrevCount(src);\r\n            while(prevCount--) {\r\n                filePath = filePath.substring(0,filePath.substr(1).lastIndexOf('/')+1);\r\n            }\r\n            return filePath + \"/\"+src.replace(/\\.\\.\\//g, \"\");\r\n        },\r\n        replaceIncludeElements: function() {\r\n            var $this = this;\r\n            var filePath = $this.getFilePath();\r\n            var includeTals = document.getElementsByTagName(\"include\");\r\n            this.forEach(includeTals, function() {\r\n                //拿到路径\r\n                var src = this.getAttribute(\"src\");\r\n                //拿到文件内容\r\n                var content = $this.getFileContent($this.getRequestUrl(filePath, src));\r\n                //将文本转换成节点\r\n                var parent = this.parentNode;\r\n                var includeNodes = $this.parseNode($this.getHtml(content));\r\n                var size = includeNodes.length;\r\n                for(var i = 0; i < size; i++) {\r\n                    parent.insertBefore(includeNodes[0], this);\r\n                }\r\n                //执行文本中的额javascript\r\n                $this.executeScript(content);\r\n                parent.removeChild(this);\r\n                //替换元素 this.parentNode.replaceChild(includeNodes[1], this);\r\n            })\r\n        }\r\n    }\r\n    window.onload = function() {\r\n        new Include().replaceIncludeElements();\r\n    }\r\n})(window, document)\r\n"]}